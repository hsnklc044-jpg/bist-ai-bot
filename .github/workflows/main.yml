name: BIST AI SYSTEM

on:
  schedule:
    - cron: "5 7 * * *"   # Her gÃ¼n 07:05
  workflow_dispatch:

jobs:
  run-bot:
    runs-on: ubuntu-latest

    steps:
      - name: Repo indir
        uses: actions/checkout@v4

      - name: Python kur
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: KÃ¼tÃ¼phaneleri yÃ¼kle
        run: pip install yfinance pandas numpy requests python-telegram-bot

      - name: AI sistemi Ã§alÄ±ÅŸtÄ±r
        run: python bot.py

      # ðŸ”Ž TELEGRAM TEST ADIMI (KRÄ°TÄ°K)
      - name: Telegram test mesajÄ±
        run: |
          python - <<EOF
          import os, requests

          token = os.getenv("TELEGRAM_TOKEN")
          chat = os.getenv("TELEGRAM_CHAT_ID")

          print("TOKEN:", token)
          print("CHAT:", chat)

          if token and chat:
              requests.post(
                  f"https://api.telegram.org/bot{token}/sendMessage",
                  json={"chat_id": chat, "text": "âœ… TEST MESAJI GELDÄ°"}
              )
          else:
              print("ENV DEÄžÄ°ÅžKENLERÄ° YOK!")
          EOF
